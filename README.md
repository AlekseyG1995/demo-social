# demo-social

- тестовое задание:

```
Тестовое задание
Задача: создать веб-приложение с использованием 	 	 	       					   ReactJs+Node.js(express.js)+MongoDB
1.	Главная страница (route /):
1.1. Форма регистрации. Поля – имя, email, пароль, дата рождения, пол, фото 	 		       профиля;
1.2. Форма авторизации;
2. 	Профиль (route /account):
2.1. Форма редактирования полей – имя, пароль, фото профиля;
3.	Аккаунты (route /people)
	3.1. Отображение карточек пользователя других юзеров;
–	При заходе на данную страницу отображается список всех пользователя кроме текущего.
	3.2. Карточка аккаунта состоит из:
–	фото профиля;
–	имя;
–	возраст;
4.	Сдача проекта – ссылка на github или gitlab

Примечание
–	Постарайтесь отобразить в работе, что умеете работать как и с готовыми решениями так и создавать свои.
–	Не забывайте про визуальную эстетику создаваемого вами приложени.

```

## 1 итерация

### используемый стек

- Frontend
  - React & Redux
    - React-hooks-form
    - React-router-dom
    - Prop-types
  - MaterialUI
  - Eslint (google-config)
  - Express (for deploy)
- Backend
  - express (express-validator)
  - jsonwebtoken, bcript, multer
  - Eslint (google-config)
  - Mongoose (ODM Mongodb)

### deploy

- данное приложение задеплоено с помощью [heroku](https://mini-social-project.herokuapp.com/)
- к сожалению, из-за бесплатной версии хранилище регулярно очищается, загруженные изображения в качестве аватарок будут доступны в течении нескольких минут
  > при самостоятельной сборке проекта важно обратить внимание на ключевые моменты. Фронтенд: указать адрес сервера ( _config.js_ ). Сервер: указать строку подключения к БД( _process.env.DB_STRING_ )

## 2 итерация

#### Полученные рекомендации

- Не хранить пол юзера в String
- При загрузке нового изображения удалять старое
- Использование шаблона DTO
- При регистрации проверять существования email, а затем загружать изображение

#### Исправления и доработки

- Server
  - исправлены недочеты, описанные в полученных рекомендациях
  - улучшенная авторизация
    - вместо accessToken'a используется пара (access, refresh)
      - access - localstorage
      - refresh - httpOnly cookie
    - реализвано подтвержение email'a по почте
      - при выводе пользователей кроме текущего отображаются только подтвержденные
    - расширена БД - действующий refreshToken хранится в БД
  - реализован дополнительный сервисный слой
  - реализован отдельный класс ошибок, работающий в связке с соотвествующим middleware
- Client
  - используется кастомный instance Axios, включающий interceptor'ы для комфортной работы с jwt-токенами
  - реализован дополнительный сервисный слой

### deploy

- актуальная версия [heroku](https://demo-social-client.herokuapp.com/)

#### самостоятельная сборка

- Frontend
  - указать в _config.js_ актуальный адрес до api сервера (например, `http://localhost:5005/api/`)
- Backend
  - необходимо установать ряд переменный окружения

| Name               |              Example               |                Description                |
| :----------------- | :--------------------------------: | :---------------------------------------: |
| DB_STRING          | `mongodb://localhost:27017/testDB` |       строка подключения к MongoDB        |
| STATIC_FOLDER_NAME |             `storage`              | имя директории для хрананения изображения |
| JWT_ACCESS_SECRET  |            `secretKey1`            |      ключ для подписи accessToken'а       |
| JWT_REFRESH_SECRET |            `secretKey2`            |      ключ для подписи refreshToken'а      |
| SMTP_HOST          |          `smtp.yandex.ru`          |     адрес сервера для отправки почты      |
| SMTP_PORT          |               `587`                |      порт сервера для отправки почты      |
| SMTP_USER          |          `test@yandex.ru`          |                логин почты                |
| SMTP_PASSWORD      |             `P@$$w0rd`             |               пароль почты                |
| API_URL            |      `http://localhost:5005`       |           текущий адрес сервера           |
| CLIENT_URL         |      `http://localhost:3000`       |           текущий адрес клиента           |
